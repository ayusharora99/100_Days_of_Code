---
title: "Hit Probabiity Prediction Model"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
devtools::install_github("BillPetti/baseballr")
install.packages('tidyverse')
install.packages('gam')
library(tidyverse)
library(baseballr)
library(readr)
library(dplyr)
library(ggplot2)
library(caTools)
library(gam)

```


2019:
```{r}
s1 <- scrape_statcast_savant_batter_all("2019-04-02", 
                                        "2019-04-08")
s2 <- scrape_statcast_savant_batter_all("2019-04-09", 
                                        "2019-04-15")
s3 <- scrape_statcast_savant_batter_all("2019-04-16", 
                                        "2019-04-22")
s4 <- scrape_statcast_savant_batter_all("2019-04-23", 
                                        "2019-04-29")
s5 <- scrape_statcast_savant_batter_all("2019-04-30", 
                                        "2019-05-06")
s6 <- scrape_statcast_savant_batter_all("2019-05-07", 
                                        "2019-05-13")
s7 <- scrape_statcast_savant_batter_all("2019-05-14", 
                                        "2019-05-20")
s8 <- scrape_statcast_savant_batter_all("2019-05-21", 
                                        "2019-05-27")
s9 <- scrape_statcast_savant_batter_all("2019-05-28", 
                                        "2019-06-03")
s10 <- scrape_statcast_savant_batter_all("2019-06-04", 
                                         "2019-06-10")
s11 <- scrape_statcast_savant_batter_all("2019-06-11", 
                                         "2019-06-17")
s12 <- scrape_statcast_savant_batter_all("2019-06-18", 
                                         "2019-06-24")
s13 <- scrape_statcast_savant_batter_all("2019-06-25", 
                                         "2019-07-01")
s14 <- scrape_statcast_savant_batter_all("2019-07-02", 
                                         "2019-07-08")
s15 <- scrape_statcast_savant_batter_all("2019-07-09", 
                                         "2019-07-15")
s16 <- scrape_statcast_savant_batter_all("2019-07-16", 
                                         "2019-07-22")
s17 <- scrape_statcast_savant_batter_all("2019-07-23", 
                                         "2019-07-29")
s18 <- scrape_statcast_savant_batter_all("2019-07-30", 
                                         "2019-08-05")
s19 <- scrape_statcast_savant_batter_all("2019-08-06", 
                                         "2019-08-12")
s20 <- scrape_statcast_savant_batter_all("2019-08-13", 
                                         "2019-08-19")
s21 <- scrape_statcast_savant_batter_all("2019-08-20", 
                                         "2019-08-26")
s22 <- scrape_statcast_savant_batter_all("2019-08-27", 
                                         "2019-09-02")
s23 <- scrape_statcast_savant_batter_all("2019-09-03", 
                                         "2019-09-09")
s24 <- scrape_statcast_savant_batter_all("2019-09-10", 
                                         "2019-09-16")
s25 <- scrape_statcast_savant_batter_all("2019-09-17", 
                                         "2019-09-23")
s26 <- scrape_statcast_savant_batter_all("2019-09-24", 
                                         "2019-09-30")
s27 <- scrape_statcast_savant_batter_all("2019-10-01", 
                                         "2019-11-01")

sc1 <- rbind(s1, s2, s3, s4, s5, s6, s7, s8, s9, s10,
             s11, s12, s13, s14)
sc2 <- rbind(s15, s16, s17, s18, s19, s20, s21,
             s22, s23, s24, s25, s26, s27)

statcast_2019 <- rbind(sc1, sc2)
write_csv(statcast_2019, "statcast2019.csv")

```

2018:
```{r}
s1 <- scrape_statcast_savant_batter_all("2018-04-02", 
                                        "2018-04-08")
s2 <- scrape_statcast_savant_batter_all("2018-04-09", 
                                        "2018-04-15")
s3 <- scrape_statcast_savant_batter_all("2018-04-16", 
                                        "2018-04-22")
s4 <- scrape_statcast_savant_batter_all("2018-04-23", 
                                        "2018-04-29")
s5 <- scrape_statcast_savant_batter_all("2018-04-30", 
                                        "2018-05-06")
s6 <- scrape_statcast_savant_batter_all("2018-05-07", 
                                        "2018-05-13")
s7 <- scrape_statcast_savant_batter_all("2018-05-14", 
                                        "2018-05-20")
s8 <- scrape_statcast_savant_batter_all("2018-05-21", 
                                        "2018-05-27")
s9 <- scrape_statcast_savant_batter_all("2018-05-28", 
                                        "2018-06-03")
s10 <- scrape_statcast_savant_batter_all("2018-06-04", 
                                         "2018-06-10")
s11 <- scrape_statcast_savant_batter_all("2018-06-11", 
                                         "2018-06-17")
s12 <- scrape_statcast_savant_batter_all("2018-06-18", 
                                         "2018-06-24")
s13 <- scrape_statcast_savant_batter_all("2018-06-25", 
                                         "2018-07-01")
s14 <- scrape_statcast_savant_batter_all("2018-07-02", 
                                         "2018-07-08")
s15 <- scrape_statcast_savant_batter_all("2018-07-09", 
                                         "2018-07-15")
s16 <- scrape_statcast_savant_batter_all("2018-07-16", 
                                         "2018-07-22")
s17 <- scrape_statcast_savant_batter_all("2018-07-23", 
                                         "2018-07-29")
s18 <- scrape_statcast_savant_batter_all("2018-07-30", 
                                         "2018-08-05")
s19 <- scrape_statcast_savant_batter_all("2018-08-06", 
                                         "2018-08-12")
s20 <- scrape_statcast_savant_batter_all("2018-08-13", 
                                         "2018-08-19")
s21 <- scrape_statcast_savant_batter_all("2018-08-20", 
                                         "2018-08-26")
s22 <- scrape_statcast_savant_batter_all("2018-08-27", 
                                         "2018-09-02")
s23 <- scrape_statcast_savant_batter_all("2018-09-03", 
                                         "2018-09-09")
s24 <- scrape_statcast_savant_batter_all("2018-09-10", 
                                         "2018-09-16")
s25 <- scrape_statcast_savant_batter_all("2018-09-17", 
                                         "2018-09-23")
s26 <- scrape_statcast_savant_batter_all("2018-09-24", 
                                         "2018-09-30")
s27 <- scrape_statcast_savant_batter_all("2018-10-01", 
                                         "2018-11-01")

sc1 <- rbind(s1, s2, s3, s4, s5, s6, s7, s8, s9, s10,
             s11, s12, s13, s14)
sc2 <- rbind(s15, s16, s17, s18, s19, s20, s21,
             s22, s23, s24, s25, s26, s27)

statcast_2018 <- rbind(sc1, sc2)
write_csv(statcast_2018, "statcast2018.csv")
```

2017: 
```{r}
s1 <- scrape_statcast_savant_batter_all("2017-04-02", 
                                        "2017-04-08")
s2 <- scrape_statcast_savant_batter_all("2017-04-09", 
                                        "2017-04-15")
s3 <- scrape_statcast_savant_batter_all("2017-04-16", 
                                        "2017-04-22")
s4 <- scrape_statcast_savant_batter_all("2017-04-23", 
                                        "2017-04-29")
s5 <- scrape_statcast_savant_batter_all("2017-04-30", 
                                        "2017-05-06")
s6 <- scrape_statcast_savant_batter_all("2017-05-07", 
                                        "2017-05-13")
s7 <- scrape_statcast_savant_batter_all("2017-05-14", 
                                        "2017-05-20")
s8 <- scrape_statcast_savant_batter_all("2017-05-21", 
                                        "2017-05-27")
s9 <- scrape_statcast_savant_batter_all("2017-05-28", 
                                        "2017-06-03")
s10 <- scrape_statcast_savant_batter_all("2017-06-04", 
                                         "2017-06-10")
s11 <- scrape_statcast_savant_batter_all("2017-06-11", 
                                         "2017-06-17")
s12 <- scrape_statcast_savant_batter_all("2017-06-18", 
                                         "2017-06-24")
s13 <- scrape_statcast_savant_batter_all("2017-06-25", 
                                         "2017-07-01")
s14 <- scrape_statcast_savant_batter_all("2017-07-02", 
                                         "2017-07-08")
s15 <- scrape_statcast_savant_batter_all("2017-07-09", 
                                         "2017-07-15")
s16 <- scrape_statcast_savant_batter_all("2017-07-16", 
                                         "2017-07-22")
s17 <- scrape_statcast_savant_batter_all("2017-07-23", 
                                         "2017-07-29")
s18 <- scrape_statcast_savant_batter_all("2017-07-30", 
                                         "2017-08-05")
s19 <- scrape_statcast_savant_batter_all("2017-08-06", 
                                         "2017-08-12")
s20 <- scrape_statcast_savant_batter_all("2017-08-13", 
                                         "2017-08-19")
s21 <- scrape_statcast_savant_batter_all("2017-08-20", 
                                         "2017-08-26")
s22 <- scrape_statcast_savant_batter_all("2017-08-27", 
                                         "2017-09-02")
s23 <- scrape_statcast_savant_batter_all("2017-09-03", 
                                         "2017-09-09")
s24 <- scrape_statcast_savant_batter_all("2017-09-10", 
                                         "2017-09-16")
s25 <- scrape_statcast_savant_batter_all("2017-09-17", 
                                         "2017-09-23")
s26 <- scrape_statcast_savant_batter_all("2017-09-24", 
                                         "2017-09-30")
s27 <- scrape_statcast_savant_batter_all("2017-10-01", 
                                         "2017-11-01")

sc1 <- rbind(s1, s2, s3, s4, s5, s6, s7, s8, s9, s10,
             s11, s12, s13, s14)
sc2 <- rbind(s15, s16, s17, s18, s19, s20, s21,
             s22, s23, s24, s25, s26, s27)

statcast_2017 <- rbind(sc1, sc2)
write_csv(statcast_2017, "statcast2017.csv")
```

2016:
```{r}
s1 <- scrape_statcast_savant_batter_all("2016-04-02", 
                                        "2016-04-08")
s2 <- scrape_statcast_savant_batter_all("2016-04-09", 
                                        "2016-04-15")
s3 <- scrape_statcast_savant_batter_all("2016-04-16", 
                                        "2016-04-22")
s4 <- scrape_statcast_savant_batter_all("2016-04-23", 
                                        "2016-04-29")
s5 <- scrape_statcast_savant_batter_all("2016-04-30", 
                                        "2016-05-06")
s6 <- scrape_statcast_savant_batter_all("2016-05-07", 
                                        "2016-05-13")
s7 <- scrape_statcast_savant_batter_all("2016-05-14", 
                                        "2016-05-20")
s8 <- scrape_statcast_savant_batter_all("2016-05-21", 
                                        "2016-05-27")
s9 <- scrape_statcast_savant_batter_all("2016-05-28", 
                                        "2016-06-03")
s10 <- scrape_statcast_savant_batter_all("2016-06-04", 
                                         "2016-06-10")
s11 <- scrape_statcast_savant_batter_all("2016-06-11", 
                                         "2016-06-17")
s12 <- scrape_statcast_savant_batter_all("2016-06-18", 
                                         "2016-06-24")
s13 <- scrape_statcast_savant_batter_all("2016-06-25", 
                                         "2016-07-01")
s14 <- scrape_statcast_savant_batter_all("2016-07-02", 
                                         "2016-07-08")
s15 <- scrape_statcast_savant_batter_all("2016-07-09", 
                                         "2016-07-15")
s16 <- scrape_statcast_savant_batter_all("2016-07-16", 
                                         "2016-07-22")
s17 <- scrape_statcast_savant_batter_all("2016-07-23", 
                                         "2016-07-29")
s18 <- scrape_statcast_savant_batter_all("2016-07-30", 
                                         "2016-08-05")
s19 <- scrape_statcast_savant_batter_all("2016-08-06", 
                                         "2016-08-12")
s20 <- scrape_statcast_savant_batter_all("2016-08-13", 
                                         "2016-08-19")
s21 <- scrape_statcast_savant_batter_all("2016-08-20", 
                                         "2016-08-26")
s22 <- scrape_statcast_savant_batter_all("2016-08-27", 
                                         "2016-09-02")
s23 <- scrape_statcast_savant_batter_all("2016-09-03", 
                                         "2016-09-09")
s24 <- scrape_statcast_savant_batter_all("2016-09-10", 
                                         "2016-09-16")
s25 <- scrape_statcast_savant_batter_all("2016-09-17", 
                                         "2016-09-23")
s26 <- scrape_statcast_savant_batter_all("2016-09-24", 
                                         "2016-09-30")
s27 <- scrape_statcast_savant_batter_all("2016-10-01", 
                                         "2016-11-01")

sc1 <- rbind(s1, s2, s3, s4, s5, s6, s7, s8, s9, s10,
             s11, s12, s13, s14)
sc2 <- rbind(s15, s16, s17, s18, s19, s20, s21,
             s22, s23, s24, s25, s26, s27)

statcast_2016 <- rbind(sc1, sc2)
write_csv(statcast_2016, "statcast2016.csv")
```

2015:
```{r}
s1 <- scrape_statcast_savant_batter_all("2015-04-02", 
                                        "2015-04-08")
s2 <- scrape_statcast_savant_batter_all("2015-04-09", 
                                        "2015-04-15")
s3 <- scrape_statcast_savant_batter_all("2015-04-16", 
                                        "2015-04-22")
s4 <- scrape_statcast_savant_batter_all("2015-04-23", 
                                        "2015-04-29")
s5 <- scrape_statcast_savant_batter_all("2015-04-30", 
                                        "2015-05-06")
s6 <- scrape_statcast_savant_batter_all("2015-05-07", 
                                        "2015-05-13")
s7 <- scrape_statcast_savant_batter_all("2015-05-14", 
                                        "2015-05-20")
s8 <- scrape_statcast_savant_batter_all("2015-05-21", 
                                        "2015-05-27")
s9 <- scrape_statcast_savant_batter_all("2015-05-28", 
                                        "2015-06-03")
s10 <- scrape_statcast_savant_batter_all("2015-06-04", 
                                         "2015-06-10")
s11 <- scrape_statcast_savant_batter_all("2015-06-11", 
                                         "2015-06-17")
s12 <- scrape_statcast_savant_batter_all("2015-06-18", 
                                         "2015-06-24")
s13 <- scrape_statcast_savant_batter_all("2015-06-25", 
                                         "2015-07-01")
s14 <- scrape_statcast_savant_batter_all("2015-07-02", 
                                         "2015-07-08")
s15 <- scrape_statcast_savant_batter_all("2015-07-09", 
                                         "2015-07-15")
s16 <- scrape_statcast_savant_batter_all("2015-07-16", 
                                         "2015-07-22")
s17 <- scrape_statcast_savant_batter_all("2015-07-23", 
                                         "2015-07-29")
s18 <- scrape_statcast_savant_batter_all("2015-07-30", 
                                         "2015-08-05")
s19 <- scrape_statcast_savant_batter_all("2015-08-06", 
                                         "2015-08-12")
s20 <- scrape_statcast_savant_batter_all("2015-08-13", 
                                         "2015-08-19")
s21 <- scrape_statcast_savant_batter_all("2015-08-20", 
                                         "2015-08-26")
s22 <- scrape_statcast_savant_batter_all("2015-08-27", 
                                         "2015-09-02")
s23 <- scrape_statcast_savant_batter_all("2015-09-03", 
                                         "2015-09-09")
s24 <- scrape_statcast_savant_batter_all("2015-09-10", 
                                         "2015-09-16")
s25 <- scrape_statcast_savant_batter_all("2015-09-17", 
                                         "2015-09-23")
s26 <- scrape_statcast_savant_batter_all("2015-09-24", 
                                         "2015-09-30")
s27 <- scrape_statcast_savant_batter_all("2015-10-01", 
                                         "2015-11-01")

sc1 <- rbind(s1, s2, s3, s4, s5, s6, s7, s8, s9, s10,
             s11, s12, s13, s14)
sc2 <- rbind(s15, s16, s17, s18, s19, s20, s21,
             s22, s23, s24, s25, s26, s27)

statcast_2015 <- rbind(sc1, sc2)
write_csv(statcast_2015, "statcast2015.csv")
```
```{r}
statcast = rbind(statcast2015, statcast_2016, statcast_2017, statcast_2018, statcast_2019)
summary(statcast)
```

Setting up 2019 dataset
```{r}
statcast2019 <- read.csv("~/Documents/100_Days_of_Code/100_Days_of_Code/R_Studio/statcast2019.csv")



data_2019 = statcast2019[ ,c("player_name","type" ,"events","launch_speed", "launch_angle", "hit_distance_sc")]

# only X
unique(data_2019$type)

data_2019 = subset(data_2019, type == 'X')

# only GIDP, field_out, single, double, home_run, triple, force_out, triple, double_play, fielders_choice_out, fielders_choice, sac_fly_double_play, triple_play, sac_bunt_double_play

# Only groundout, flyout, single, double, triple, home run

unique(data_2019$events)



# Filter by outs
data_2019_outs = data_2019 %>%
  filter(events == c('grounded_into_double_play',"field_out", "force_out","fielders_choice_out", "sac_fly_double_play", "triple_play", "sac_bunt_double_play"))

# Filter by singles, doubles, triples
data_2019_base_hits = data_2019 %>%
  filter(events == c("single", "double", "triple"))
data_2019_base_hits['events'] = 'Base Hit'

# Filter by homeruns
data_2019_homeruns = data_2019 %>%
  filter(events == c("home_run"))
data_2019_homeruns['events'] = "Home Run"

data_2019_outs['events'] = "Out"
unique(data_2019_outs$events)

data_2019 = rbind(data_2019_outs, data_2019_base_hits, data_2019_homeruns)

unique(data_2019$events)

```

Testing
```{r}
out = data_2019 %>%
  filter(events == 'Out')

head_out = head(out)

hit = data_2019 %>%
  filter(events == 'Base Hit')

head_hit = head(hit)

hr = data_2019 %>%
  filter(events == 'Home Run')

head_hr = head(hr)

summary(hr)

```

Visual for Launch Angle vs Hit Speed (Color Coded for Out, Hit, HomeRun)
```{r}
plot = ggplot(data_2019, aes(x = launch_speed, y = launch_angle, col = events))+
  geom_point()+
  xlim(25,125)+
  ggtitle('2019 Season Batted Balls')

ggsave('plot_2019.png')

plot
```

TRAINING AND TESTING:


```{r}
data_2019$outcome = ifelse(data_2019$events == c("Base Hit", "Home Run"),1,0)
data_2019$hr = ifelse(data_2019$events == "Home Run",1,0)

data_for_predict = data_2019[,c("launch_speed","launch_angle","hit_distance_sc","outcome","hr")]



data_for_predict = na.exclude(data_for_predict)

set.seed(123)
sample = sample.split(data_for_predict,SplitRatio = 0.75)
train1 =subset(data_for_predict,sample ==TRUE)
test1 = subset(data_for_predict,sample == FALSE)
```

GAM model:
```{r}
unique(data_for_predict$outcome)


fit <- gam(outcome ~ s(launch_angle, launch_speed, hit_distance_sc),
             family = binomial,
             data = data_for_predict)

Prob_Hit = exp(predict(fit))/(1 + exp(predict(fit)))



p2 <- ggplot(data_for_predict, aes(x = data_for_predict$launch_speed, y = data_for_predict$launch_angle,
color = Prob_Hit)) + geom_point() + scale_colour_gradient(limits = c(0, 1),
low = "blue", high = "red") + geom_hline(yintercept = 0, color = "blue") + ggtitle(paste("Hit Probability"))
p2

ggsave("hit_prob.png")
  
```

```{r}
unique(data_for_predict$hr)

fit <- gam(hr ~ s(launch_angle, launch_speed,hit_distance_sc),
             family = binomial,
             data = data_for_predict)

Prob_Hr = exp(predict(fit))/(1 + exp(predict(fit)))

p2 <- ggplot(data_for_predict, aes(x = data_for_predict$launch_speed, y = data_for_predict$launch_angle,
color = Prob_Hr)) + geom_point() + scale_colour_gradient(limits = c(0, 1),
low = "blue", high = "red") + geom_hline(yintercept = 0, color = "blue") + ggtitle(paste("Reach Base Probabilities"))
p2

ggsave("hr_prob.png")
```



```{r}
statcast2018 <- read.csv("~/Documents/100_Days_of_Code/100_Days_of_Code/R_Studio/statcast2018.csv")

summary(statcast2018)

data_2018 = statcast2018[ ,c("type" ,"events","launch_speed", "launch_angle", "hit_distance_sc")]

# only X
unique(data_2018$type)

data_2018 = subset(data_2018, type == 'X')

# only GIDP, field_out, single, double, home_run, triple, force_out, triple, double_play, fielders_choice_out, fielders_choice, sac_fly_double_play, triple_play, sac_bunt_double_play

# Only groundout, flyout, single, double, triple, home run

unique(data_2018$events)



# Filter by outs
data_2018_outs = data_2018 %>%
  filter(events == c('grounded_into_double_play',"field_out", "force_out","fielders_choice_out", "sac_fly_double_play", "triple_play", "sac_bunt_double_play"))

# Filter by singles, doubles, triples
data_2018_base_hits = data_2018 %>%
  filter(events == c("single", "double", "triple"))
data_2018_base_hits['events'] = 'Base Hit'

# Filter by homeruns
data_2018_homeruns = data_2018 %>%
  filter(events == c("home_run"))
data_2018_homeruns['events'] = "Home Run"

data_2018_outs['events'] = "Out"
unique(data_2018_outs$events)

data_2018 = rbind(data_2018_outs, data_2018_base_hits, data_2018_homeruns)

unique(data_2018$events)

```

Testing
```{r}
out = data_2018 %>%
  filter(events == 'Out')

head_out = head(out)

hit = data_2018 %>%
  filter(events == 'Base Hit')

head_hit = head(hit)

hr = data_2018 %>%
  filter(events == 'Home Run')

head_hr = head(hr)

```

Visual for Launch Angle vs Hit Speed (Color Coded for Out, Hit, HomeRun)
```{r}
plot = ggplot(data_2018, aes(x = launch_speed, y = launch_angle, col = events))+
  geom_point()+
  xlim(25,125)+
  ggtitle("2018 Season Batted Balls")

ggsave('plot_2018.png')

plot
```

Postseason Graph
```{r}

postseason_2019 <- read_csv("postseason_2019_l.csv")

postseason_2019 = postseason_2019[ ,c("type" ,"events","launch_speed", "launch_angle", "hit_distance_sc",'des')]






# Filter by outs
postseason_2019_outs = postseason_2019 %>%
  filter(events == c('grounded_into_double_play',"field_out", "force_out","fielders_choice_out", "sac_fly_double_play", "triple_play", "sac_bunt_double_play"))

# Filter by singles, doubles, triples
postseason_2019_base_hits = postseason_2019 %>%
  filter(events == c("single", "double", "triple"))
postseason_2019_base_hits['events'] = 'Base Hit'

# Filter by homeruns
postseason_2019_homeruns = postseason_2019 %>%
  filter(events == c("home_run"))
postseason_2019_homeruns['events'] = "Home Run"

postseason_2019_outs['events'] = "Out"
unique(postseason_2019_outs$events)

postseason_2019 = rbind(postseason_2019_outs, postseason_2019_base_hits, postseason_2019_homeruns)

unique(postseason_2019$events)

out = postseason_2019 %>%
  filter(events == 'Out')

head_out = head(out)

hit = postseason_2019 %>%
  filter(events == 'Base Hit')

head_hit = head(hit)

hr = postseason_2019 %>%
  filter(events == 'Home Run')

head_hr = head(hr)

summary(hr)

typeof(postseason_2019$events)


postseason_2019$launch_speed <- as.numeric(as.character(postseason_2019$launch_speed))
postseason_2019$launch_angle <- as.numeric(as.character(postseason_2019$launch_angle))
postseason_2019$hit_distance_sc <- as.numeric(as.character(postseason_2019$hit_distance_sc))


view(postseason_2019)
plot = ggplot(postseason_2019, aes(x = launch_speed, y = launch_angle, col = events))+
  geom_point()+
  xlim(25,125)+
  ggtitle("2019 Postseason Season Batted Balls")

plot

ggsave('plot_2019_p.png')

```
Comparing 2019 & Postseason

```{r}
# average LA and LS for HR in 2019 P


postseason_hrs = postseason_hrs[ ,c("type" ,"events","launch_speed", "launch_angle", "hit_distance_sc")]

summary(postseason_hrs)

```

Comparing 2019 to 2019 Postseason:
```{r}
data_2019_90 = data_2019 %>%
  filter((launch_speed >= 98 & launch_angle >= 26 & launch_angle <= 30) | (launch_speed >= 99 & launch_angle >= 25 & launch_angle <= 31) | (launch_speed >= 100 & launch_angle >= 24 & launch_angle <= 32))

postseason_2019_90 = postseason_2019 %>%
  filter((launch_speed >= 98 & launch_angle >= 26 & launch_angle <= 30) | (launch_speed >= 99 & launch_angle >= 25 & launch_angle <= 31) | (launch_speed >= 100 & launch_angle >= 24 & launch_angle <= 32))

prop.table(table(data_2019_90$events))
prop.table(table(postseason_2019_90$events))

summary(data_2019_90$hit_distance_sc)
summary(postseason_2019_90$hit_distance_sc)


data_Didi = data_2019 %>%
  filter(launch_speed <= 100 & launch_angle >= 41)

prop.table(table(data_Didi$events))
```

```

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

